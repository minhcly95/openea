<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>OpenEA: Control the algorithm via CLI options</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenEA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('tut3.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Control the algorithm via CLI options </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#tut3-var">Variables</a></li>
<li class="level1"><a href="#tut3-log">Log redirection</a></li>
<li class="level1"><a href="#tut3-term">More Termination conditions</a></li>
<li class="level1"><a href="#tut3-backup">Back-up and Restore</a></li>
<li class="level1"><a href="#tut3-multithread">Multi-threading</a></li>
<li class="level1"><a href="#tut3-conclusion">Conclusion</a></li>
</ul>
</div>
<div class="textblock"><p>This page describes how to use CLI options to add features to the algorithm.</p>
<dl class="section user"><dt>Tutorial level</dt><dd>Beginner</dd></dl>
<dl class="section user"><dt>Previous tutorial</dt><dd><a class="el" href="tut2.html">Solve the One-Max problem using the CLI</a></dd></dl>
<dl class="section user"><dt>Next tutorial</dt><dd><a class="el" href="tut4.html">Write custom operators using the API</a></dd></dl>
<p>In the CLI toolset, options are added after the path to EAML file. The basic syntax to use CLI with options is:</p>
<div class="fragment"><div class="line">openea run &lt;eaml_file&gt; &lt;options&gt;</div></div><!-- fragment --><h1><a class="anchor" id="tut3-var"></a>
Variables</h1>
<p>Imagine that you are tuning your algorithm and you need to adjust an attribute multiple times. Even we can use EAML configuration file to avoid re-compiling our code, it is still annoying to edit the EAML file for each different parameter value, and this process can't be automated also (it can, but you will need an EAML file reader to do that). The library allows you to have a placeholder name (called <b>variable</b>) for an attribute in EAML file, which you can use later to set its value on the CLI. For example, to make the population size become a variable, modify the EAML like this:</p>
<div class="fragment"><div class="line">&lt;EvolutionStrategy size=<span class="stringliteral">&quot;100|popSize&quot;</span>&gt;</div><div class="line">...</div><div class="line">&lt;/EvolutionStrategy&gt;</div></div><!-- fragment --><p>Now we have a variable named <code><b>"popSize"</b></code>. You can run your configuration file with a new variable value by entering this command:</p>
<div class="fragment"><div class="line">openea run OneMax.eaml --popSize=50</div></div><!-- fragment --><p>then the population size will be changed to 50. If you don't set your variable (i.e. no <code>"--popSize=50"</code> part), the CLI will use the default value of 100. Conclusively, you can define a variable in an EAML file by this syntax:</p>
<div class="fragment"><div class="line">attribute-name=<span class="stringliteral">&quot;defaultValue|variableName&quot;</span></div></div><!-- fragment --><p>And then use it later in the CLI toolset by adding the option <code><b>"--"</b></code>:</p>
<div class="fragment"><div class="line">--variableName=newValue</div></div><!-- fragment --><p>Of course you can have multiple variables in your EAML file, you can define a new variable for the bit string length:</p>
<div class="fragment"><div class="line">...</div><div class="line">&lt;<a class="code" href="namespaceea.html#a377468eec6ac0d62b5b199ec0add3bfb">BoolRandomArrayInitializer</a> length=<span class="stringliteral">&quot;50|stringLength&quot;</span>/&gt;</div><div class="line">...</div></div><!-- fragment --><p>Then set both variables by appending the option <code><b>"--"</b></code>:</p>
<div class="fragment"><div class="line">openea run OneMax.eaml --popSize=50 --stringLength=10</div></div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The order of options is not important. You can set all variables at once, set some of them or set none of them. For variables which are unset, the default value will be used.</dd></dl>
<h1><a class="anchor" id="tut3-log"></a>
Log redirection</h1>
<p>When running previous tutorials, you can notice that there are some output lines with color and some not. Those colors represent different log levels, and they can be configured so you can choose to show them or not, or to redirect them to files. There is four log levels in the library:</p>
<ul>
<li><b>Trace</b> (blue): show which phase of the evolution process is currently running.</li>
<li><b>Debug</b> (yellow): show system information like which module is enable and when has the evolution process started.</li>
<li><b>Info</b> (normal): show user information like best genome and fitness value.</li>
<li><b>Error</b> (red): show error messages.</li>
</ul>
<p>To redirect log levels, you use the option <code><b>"-l"</b></code>:</p>
<div class="fragment"><div class="line">-l&lt;levels&gt;=&lt;targets&gt;</div><div class="line">-l&lt;levels&gt;+&lt;targets&gt;</div></div><!-- fragment --><p>The first option will redirect <code>&lt;levels&gt;</code> to <code>&lt;targets&gt;</code> while discarding old targets and the second will append <code>&lt;targets&gt;</code> to the target list. <code>&lt;levels&gt;</code> can contain letters representing the levels like <code>'t'</code> (trace), <code>'d'</code> (debug), <code>'i'</code> (info) and <code>'e'</code> (error). You can use multiple letters in a same option at once. The <code>&lt;targets&gt;</code> is the redirection target, which might be <code>"stdout"</code>, <code>"stderr"</code> or a path to a file (relative or absolute). You can also have multiple targets separated my comma (<code>,</code>) in a same option. For example:</p>
<div class="fragment"><div class="line">-ltd=<span class="stringliteral">&quot;stdout,log.txt&quot;</span></div></div><!-- fragment --><p>will redirect the trace and the debug levels to both the <code>stdout</code> and a file named <code>log.txt</code>. If the file exists, the log will be <b>appended</b> (not overriden). The above option is the same with:</p>
<div class="fragment"><div class="line">-lt=<span class="stringliteral">&quot;stdout&quot;</span> -ld=<span class="stringliteral">&quot;stdout&quot;</span> -lt+<span class="stringliteral">&quot;log.txt&quot;</span> -ld+<span class="stringliteral">&quot;log.txt&quot;</span></div></div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Log levels doesn't affect others, so enable a level won't enable or disable any other level. The order of letters in <code>&lt;levels&gt;</code> is not important, but cannot be duplicated in one option. However, the order of options in the same level is important. The latest redirection option will override all previous options.</dd>
<dd>
Notice that if you add a target twice, it will be counted as <b>twice</b>, and there will be two lines of output to the same target. So users should take a little responsibility to manage the log redirection.</dd></dl>
<p>If you want turn off some log levels, use:</p>
<div class="fragment"><div class="line">-l&lt;levels&gt;=</div></div><!-- fragment --><p>The above option means redirect <code>&lt;levels&gt;</code> to none (<code>""</code>). However, if you omit the equal sign:</p>
<div class="fragment"><div class="line">-l&lt;levels&gt;</div></div><!-- fragment --><p>That means the same as <code>-l&lt;levels&gt;=stdout</code> for non-error levels and <code>stderr</code> for error level.</p>
<p>You can also redirect all the log levels at once by using <code>&lt;levels&gt; = 'a'</code>:</p>
<div class="fragment"><div class="line">-la=&lt;targets&gt;</div></div><!-- fragment --><p>To redirect log levels in C++ code, you can look at the static class <a class="el" href="classea_1_1_log.html" title="Static class which controls log levels and redirection. ">Log</a> to redirect channels and <a class="el" href="classea_1_1_log_stream.html" title="Stream class which is used to write log. ">LogStream</a> to write actual log record.</p>
<h1><a class="anchor" id="tut3-term"></a>
More Termination conditions</h1>
<p>In previous tutorials, you have known that you can use <a class="el" href="classea_1_1_fitness_termination_hook.html" title="A Hook which will terminate the Population based on a fitness condition. ">FitnessTerminationHook</a> to terminate your algorithm. Now I introduce two more termination <a class="el" href="classea_1_1_hook.html" title="The interface for custom code execution. ">Hook</a> which are <a class="el" href="classea_1_1_generation_termination_hook.html" title="A Hook which terminates when the target generation number has been reached. ">GenerationTerminationHook</a> and <a class="el" href="classea_1_1_evaluation_termination_hook.html" title="A Hook which terminates when the target evaluation number has been reached. ">EvaluationTerminationHook</a>, which will terminate the algorithm when the target generation or the evaluation number has been reached. You can add it directly to your EAML file, but the CLI provides you a faster way to do that, the option <code><b>"-t"</b></code>:</p>
<div class="fragment"><div class="line">-tg&lt;target&gt; or -tg=&lt;target&gt;</div><div class="line">-te&lt;target&gt; or -te=&lt;target&gt;</div></div><!-- fragment --><p>The first one will add a <a class="el" href="classea_1_1_generation_termination_hook.html" title="A Hook which terminates when the target generation number has been reached. ">GenerationTerminationHook</a> to the algorithm, and the second one will add a <a class="el" href="classea_1_1_evaluation_termination_hook.html" title="A Hook which terminates when the target evaluation number has been reached. ">EvaluationTerminationHook</a>. If your EAML file has defined one or both of these two <a class="el" href="classea_1_1_hook.html" title="The interface for custom code execution. ">Hook</a>, those pre-defined <a class="el" href="classea_1_1_hook.html" title="The interface for custom code execution. ">Hook</a> will be discarded and only the one which is added by the <code><b>"-t"</b></code> option has the effect on the algorithm. Note that <a class="el" href="classea_1_1_fitness_termination_hook.html" title="A Hook which will terminate the Population based on a fitness condition. ">FitnessTerminationHook</a> won't count, so this option won't override <a class="el" href="classea_1_1_fitness_termination_hook.html" title="A Hook which will terminate the Population based on a fitness condition. ">FitnessTerminationHook</a>.</p>
<dl class="section note"><dt>Note</dt><dd>In this option (and many other options), the equal sign is optional. It is not the case for some options, e.g. <code><b>"-l"</b></code> option for log redirection.</dd></dl>
<p>For example, adding this option:</p>
<div class="fragment"><div class="line">-tg1000</div></div><!-- fragment --><p>will terminate the algorithm at generation 1000 and override all defined <a class="el" href="classea_1_1_generation_termination_hook.html" title="A Hook which terminates when the target generation number has been reached. ">GenerationTerminationHook</a> and <a class="el" href="classea_1_1_evaluation_termination_hook.html" title="A Hook which terminates when the target evaluation number has been reached. ">EvaluationTerminationHook</a>.</p>
<h1><a class="anchor" id="tut3-backup"></a>
Back-up and Restore</h1>
<p>As we have mentioned, the CLI automatically saves a back-up file at the end of the evolution process. This back-up file contains the population of the last generation, which is a list of <a class="el" href="classea_1_1_genome.html" title="The interface for representation. ">Genome</a> with its corresponding <a class="el" href="classea_1_1_fitness.html" title="The interface for general fitness. ">Fitness</a> value, all in binary form to save disk space. This file is used to restore the population if users want to, or to analyze the final result. But actually you can configure the CLI, so it will save back-up files at some frequency to a specified folder. The option is <code><b>"-b"</b></code>:</p>
<div class="fragment"><div class="line">-b&lt;folder&gt; or -b=&lt;folder&gt;</div><div class="line">-b&lt;frequency&gt;=&lt;folder&gt;</div></div><!-- fragment --><p>The first option will set the <a class="el" href="classea_1_1_backup_hook.html" title="A Hook which backs up the Population to file. ">BackupHook</a> to save the back-up file still at the end of the evolution, but in a different <code>&lt;folder&gt;</code>. The second one will save back-up files at the given frequency (in generation) additionally (so there is still a back-up file for the last generation). The back-up files will be created in the given folder and has the name <code>"generation_number.eabak"</code>. For example, if we add these options to the CLI:</p>
<div class="fragment"><div class="line">-tg9 -b2=my-backup</div></div><!-- fragment --><p>the algorithm will run for 9 generations. Each two generations, a back-up file will be generated. We also have a file for the last generation. So in total, there will be 5 files: <code>000002.eabak</code>, <code>000004.eabak</code>, <code>000006.eabak</code>, <code>000008.eabak</code> and <code>000009.eabak</code> in the <code>my-backup</code> folder (if it doesn't exist, the CLI will create it for you also).</p>
<p>To restore a population from a back-up folder, you will use the option <code><b>"-r"</b></code>:</p>
<div class="fragment"><div class="line">-r</div><div class="line">-r&lt;folder&gt; or -r=&lt;folder&gt;</div><div class="line">-r&lt;from&gt;=&lt;folder&gt;</div></div><!-- fragment --><p>The first option will restore the population from the default back-up folder (so it will restore the population from the most recent run with no <code><b>"-b"</b></code> option). The second will restore the population from the designated back-up folder (it will automatically search for the file with highest generation number). The third will restore from a given generation number instead of the highest one. For example, to restore the population from the example above, use the option:</p>
<div class="fragment"><div class="line">-r=my-backup</div></div><!-- fragment --><p>To restore from generation 4, use the option:</p>
<div class="fragment"><div class="line">-r4=my-backup</div></div><!-- fragment --><dl class="section note"><dt>Note</dt><dd><code><b>"-r"</b></code> option will automatically redirect the default back-up folder if there is no <code><b>"-b"</b></code> option (e.g. for the above option, it also adds an implicit option <code><b>"-b=my-backup"</b></code>). However, if you want to set the frequency, you need to specify the <code><b>"-b"</b></code> option explicitly.</dd></dl>
<p>For C++ users, take a look at <a class="el" href="classea_1_1_backup_hook.html" title="A Hook which backs up the Population to file. ">BackupHook</a> and <a class="el" href="classea_1_1_restore.html" title="A static class which restores the Population from a back-up file. ">Restore</a> class which provide the same functionalities.</p>
<h1><a class="anchor" id="tut3-multithread"></a>
Multi-threading</h1>
<p>Multi-threading lets your operators process faster by dividing the task into multiple threads. There is some overhead, but with 2-4 threads, multi-threading is still profitable. The operators which can be multi-threaded are <a class="el" href="classea_1_1_mutator.html" title="The interface for mutation operator. ">Mutator</a>, <a class="el" href="classea_1_1_recombinator.html" title="The interface for recombination operator. ">Recombinator</a> and <a class="el" href="classea_1_1_evaluator.html" title="The interface for evaluation method. ">Evaluator</a>.</p>
<dl class="section note"><dt>Note</dt><dd>With no <code><b>"-p"</b></code> option, the CLI toolset will enable multi-threading with default setting with the number of threads equal to the number of cores in your CPU.</dd></dl>
<p>You can know whether multi-threading is enabled or not by looking into the log:</p>
<div class="fragment"><div class="line">Parallel processing is enabled, number of threads = 4</div></div><!-- fragment --><p>The option for configuration of multi-threading feature is <code><b>"-p"</b></code> (for "p"arallelism):</p>
<div class="fragment"><div class="line">-p&lt;numOfThreads&gt; or -p=&lt;numOfThreads&gt;</div></div><!-- fragment --><p>So if you want to disable multi-threading, use the option:</p>
<div class="fragment"><div class="line">-p1</div></div><!-- fragment --><p>If you want to run with 2 threads:</p>
<div class="fragment"><div class="line">-p2</div></div><!-- fragment --><p>If you don't know the number of threads that you should use, just don't give any <code><b>"-p"</b></code> option, or you can use:</p>
<div class="fragment"><div class="line">-p0</div></div><!-- fragment --><p>which has the same meaning as the default setting.</p>
<p>For C++ users, the function <a class="el" href="classea_1_1_multi_threading.html#adab578dfbb176a43185f975afca4c473" title="Set the maximum number of threads allowed. ">MultiThreading::SetNumThreads()</a> which provides the same functionality with <code><b>"-p"</b></code> option.</p>
<h1><a class="anchor" id="tut3-conclusion"></a>
Conclusion</h1>
<p>In this tutorial, you have known how to add CLI options to enable some functionalities of the algorithm such as:</p>
<ul>
<li><code><b>"--"</b></code> option to assign EAML variables.</li>
<li><code><b>"-l"</b></code> option to redirect log levels.</li>
<li><code><b>"-t"</b></code> option to add termination conditions.</li>
<li><code><b>"-b"</b></code> option to create back-up files and <code><b>"-r"</b></code> option to restore the population from them.</li>
<li><code><b>"-p"</b></code> option to adjust the number of threads when multi-threading.</li>
</ul>
<p>In the next tutorial, we will discuss more advanced techniques, including writing custom operators:</p>
<p><a class="el" href="tut4.html">Write custom operators using the API</a></p>
<dl class="section note"><dt>Note</dt><dd>You might notice that in this tutorial, all of the features presented in the CLI toolset also have their counterpart in C++ API, because the CLI toolset is actually built on top of the API. Therefore, if you don't like the CLI toolset, you can still use all existed functionalities of the CLI in C++ code. </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
