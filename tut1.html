<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>OpenEA: How to solve the One-Max problem</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenEA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('tut1.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">How to solve the One-Max problem </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#tut1-problem">One-Max problem</a></li>
<li class="level1"><a href="#tut1-desc">Algorithm Description</a></li>
<li class="level1"><a href="#tut1-impl">Implementation</a><ul><li class="level2"><a href="#tut1-code">The Code</a></li>
<li class="level2"><a href="#tut1-compile">Compile and Run</a></li>
<li class="level2"><a href="#tut1-explain">Code Explaination</a></li>
</ul>
</li>
<li class="level1"><a href="#tut1-conclusion">Conclusion</a><ul><li class="level2"><a href="#tut1-note">Note</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>This page describes how to use the built-in operators to solve the One Max problem.</p>
<dl class="section user"><dt>Tutorial level</dt><dd>Beginner</dd></dl>
<dl class="section user"><dt>Prerequisites</dt><dd>Basic understanding about C++ and Evolutionary Computing.</dd></dl>
<dl class="section user"><dt>Next tutorial</dt><dd><a class="el" href="tut2.html">Solve the One-Max problem using the CLI</a></dd></dl>
<h1><a class="anchor" id="tut1-problem"></a>
One-Max problem</h1>
<p>The One-Max is a simple problem usually used as a demonstration of evolutionary algorithm. You can think of it as the "Hello World" program when you start learning a new programming language. The problem can be described as follow:</p>
<dl class="section user"><dt>One-Max problem</dt><dd>Find a vector \({\bf x}=\{x_1,x_2,...,x_n\}\) with \(x_i\in\{0, 1\}\), that maximizes:</dd></dl>
<p class="formulaDsp">
\[ F({\bf x}) = \sum_{i=1}^n x_i \]
</p>
<p>In other words, we need to find a bit string of 0s and 1s with the maximum number of 1s. The problem itself is easy, and we human would know the solution instantly, which is a vector of all 1s. We don't need to waste time to write a program to solve such an easy problem. However, writing "Hello World" to a piece of paper is also easy. What we need isn't to know how to solve the problem, but to know how to use the computer to solve it.</p>
<h1><a class="anchor" id="tut1-desc"></a>
Algorithm Description</h1>
<p>You need to have some understanding about evolutionary computing in order to under this part (and the rest of the tutorials). If it sounds unfamiliar to you, I recommend you to read some first chapters in the book <b>Introduction to Evolutionary Computing</b>, 2nd Edition, 2015 by <em>A.E. Eiben</em> and <em>J.E. Smith</em>. In this tutorial series, I won't talk much about the details of the operators and the representations.</p>
<p>It is a good practice to have some algorithm description before you implement your evolutionary algorithm. If you don't write it out, you will usually go off-track in this evolutionary mess. Here is the algorithm that will be implemented in this tutorial:</p>
<table class="doxtable">
<tr>
<td>Representation </td><td>An array of bits (binary string) of length <em>n</em>  </td></tr>
<tr>
<td>Evaluation function </td><td>Sum of all bits in the string  </td></tr>
<tr>
<td>Recombination </td><td>One-point crossover  </td></tr>
<tr>
<td>Number of offspring </td><td>100% population size  </td></tr>
<tr>
<td>Mutation </td><td>Flip bit  </td></tr>
<tr>
<td>Individual mutation probability </td><td>10%  </td></tr>
<tr>
<td>Gene mutation probability </td><td>1 / <em>n</em>   </td></tr>
<tr>
<td>Parent selection </td><td>Uniform (random)  </td></tr>
<tr>
<td>Survival selection </td><td>Greedy (select best)  </td></tr>
<tr>
<td>Population size </td><td>100  </td></tr>
<tr>
<td>Initialization </td><td>Random  </td></tr>
<tr>
<td>Terminal condition </td><td>Fitness value equals <em>n</em>  </td></tr>
</table>
<p>In the following implementation, we will assign the length of bit string <em>n</em> = 50.</p>
<h1><a class="anchor" id="tut1-impl"></a>
Implementation</h1>
<p>Now you know what we will implement. I think it would be better if I show you the code first then explain it line-by-line.</p>
<h2><a class="anchor" id="tut1-code"></a>
The Code</h2>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;openea/EA.h&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceea.html">ea</a>;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#define GENOME_LENGTH               50</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#define OFFSPRING_RATIO             1</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#define INDIVIDUAL_MUTATION_RATE    0.1</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#define POP_SIZE                    100</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keywordtype">int</span> main() {</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keyword">auto</span> strategy = make_shared&lt;EvolutionStrategy&gt;(POP_SIZE);</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    strategy-&gt;initializer.Create&lt;<a class="code" href="classea_1_1_random_array_initializer.html">BoolRandomArrayInitializer</a>&gt;(GENOME_LENGTH);</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    strategy-&gt;mutators.CreateBase&lt;<a class="code" href="classea_1_1_point_reset_mutation.html">FlipBitMutation</a>&gt;(1.0 / GENOME_LENGTH)-&gt;Rate(INDIVIDUAL_MUTATION_RATE);</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    strategy-&gt;recombinators.CreateBase&lt;<a class="code" href="namespaceea.html#a234746e841e0418eda3dc897df9ccb7c">BoolOnePointCrossover</a>&gt;()-&gt;Parent&lt;UniformSelection&gt;()-&gt;Ratio(OFFSPRING_RATIO);</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    strategy-&gt;survivalSelector.Create&lt;<a class="code" href="classea_1_1_greedy_selection.html">GreedySelection</a>&gt;();</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    strategy-&gt;evaluator.Create&lt;<a class="code" href="classea_1_1_typed_functional_evaluator.html">TypedFunctionalEvaluator&lt;BoolArrayGenome&gt;</a>&gt;( [] (<span class="keyword">const</span> <a class="codeRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/memory/shared_ptr.html">BoolArrayGenomePtr</a>&amp; genome) {</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <a class="codeRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/container/vector.html">vector&lt;bool&gt;</a>&amp; genes = genome-&gt;GetGenes();</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">double</span>)<a class="codeRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/algorithm/count.html">std::count</a>(genes.<a class="codeRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), genes.<a class="codeRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>(), <span class="keyword">true</span>);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    });</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    strategy-&gt;hooks.Create&lt;<a class="code" href="classea_1_1_standard_output_hook.html">StandardOutputHook</a>&gt;();</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    strategy-&gt;hooks.Create&lt;<a class="code" href="classea_1_1_fitness_termination_hook.html">FitnessTerminationHook</a>&gt;(<a class="code" href="classea_1_1_fitness_termination_hook.html#ae7ed3ee53a3f0a38f9741b4d0857859aaabc9e3441dc6ae6da9c1c3019d292048">FitnessTerminationHook::EQUAL_TO</a>, GENOME_LENGTH, <span class="keyword">false</span>);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="codeRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/memory/shared_ptr.html">SessionPtr</a> session = strategy-&gt;Evolve();</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div><div class="ttc" id="shared_ptr_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/memory/shared_ptr.html">std::shared_ptr</a></div></div>
<div class="ttc" id="classea_1_1_greedy_selection_html"><div class="ttname"><a href="classea_1_1_greedy_selection.html">ea::GreedySelection</a></div><div class="ttdoc">Implementation of Greedy selection operator. </div><div class="ttdef"><b>Definition:</b> <a href="_greedy_selection_8h_source.html#l00017">GreedySelection.h:17</a></div></div>
<div class="ttc" id="classea_1_1_random_array_initializer_html"><div class="ttname"><a href="classea_1_1_random_array_initializer.html">ea::RandomArrayInitializer</a></div><div class="ttdoc">A random Initializer for ArrayGenome. </div><div class="ttdef"><b>Definition:</b> <a href="_type_2_array_8h_source.html#l00019">Array.h:19</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div></div>
<div class="ttc" id="classea_1_1_standard_output_hook_html"><div class="ttname"><a href="classea_1_1_standard_output_hook.html">ea::StandardOutputHook</a></div><div class="ttdoc">A Hook which prints out best organism every generation. </div><div class="ttdef"><b>Definition:</b> <a href="_standard_output_hook_8h_source.html#l00015">StandardOutputHook.h:15</a></div></div>
<div class="ttc" id="classea_1_1_fitness_termination_hook_html_ae7ed3ee53a3f0a38f9741b4d0857859aaabc9e3441dc6ae6da9c1c3019d292048"><div class="ttname"><a href="classea_1_1_fitness_termination_hook.html#ae7ed3ee53a3f0a38f9741b4d0857859aaabc9e3441dc6ae6da9c1c3019d292048">ea::FitnessTerminationHook::EQUAL_TO</a></div><div class="ttdoc">Terminate if the current fitness is equal to the given one. EAML: &quot;==&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="_fitness_termination_hook_8h_source.html#l00020">FitnessTerminationHook.h:20</a></div></div>
<div class="ttc" id="end_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/end.html">std::vector::end</a></div><div class="ttdeci">T end(T...args)</div></div>
<div class="ttc" id="classea_1_1_fitness_termination_hook_html"><div class="ttname"><a href="classea_1_1_fitness_termination_hook.html">ea::FitnessTerminationHook</a></div><div class="ttdoc">A Hook which will terminate the Population based on a fitness condition. </div><div class="ttdef"><b>Definition:</b> <a href="_fitness_termination_hook_8h_source.html#l00017">FitnessTerminationHook.h:17</a></div></div>
<div class="ttc" id="classea_1_1_typed_functional_evaluator_html"><div class="ttname"><a href="classea_1_1_typed_functional_evaluator.html">ea::TypedFunctionalEvaluator</a></div><div class="ttdoc">A TypedScalarEvaluator which accepts an std::function as the evaluation function. ...</div><div class="ttdef"><b>Definition:</b> <a href="_type_2_utility_8h_source.html#l00032">Utility.h:32</a></div></div>
<div class="ttc" id="namespaceea_html"><div class="ttname"><a href="namespaceea.html">ea</a></div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00025">Common.h:25</a></div></div>
<div class="ttc" id="classea_1_1_point_reset_mutation_html"><div class="ttname"><a href="classea_1_1_point_reset_mutation.html">ea::PointResetMutation</a></div><div class="ttdoc">Implementation of Point reset mutation operator for ArrayGenome. </div><div class="ttdef"><b>Definition:</b> <a href="_type_2_array_8h_source.html#l00022">Array.h:22</a></div></div>
<div class="ttc" id="count_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/count.html">std::count</a></div><div class="ttdeci">T count(T...args)</div></div>
<div class="ttc" id="vector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a></div></div>
<div class="ttc" id="begin_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/begin.html">std::vector::begin</a></div><div class="ttdeci">T begin(T...args)</div></div>
<div class="ttc" id="namespaceea_html_a234746e841e0418eda3dc897df9ccb7c"><div class="ttname"><a href="namespaceea.html#a234746e841e0418eda3dc897df9ccb7c">ea::BoolOnePointCrossover</a></div><div class="ttdeci">OnePointCrossover&lt; bool &gt; BoolOnePointCrossover</div><div class="ttdef"><b>Definition:</b> <a href="_type_2_array_8h_source.html#l00038">Array.h:38</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="tut1-compile"></a>
Compile and Run</h2>
<p>Compile this program while linking to the library with <b>C++14 standard</b>. </p><div class="fragment"><div class="line">g++ -<a class="code" href="namespacestd.html">std</a>=c++14 -o OneMax OneMax.cpp -lopenea</div></div><!-- fragment --><p>Here is the output example when run the program (some lines of the evolution process are omitted). It may not be the same on your machine because the evolutionary process is stochastic. </p><div class="fragment"><div class="line">[2017-06-27 10:40:42.940070] Parallel processing is enabled, number of threads = 4</div><div class="line">[2017-06-27 10:40:42.941184] Population initialized, evaluation 100</div><div class="line">[2017-06-27 10:40:42.941205] Evolution started from generation 0, evaluation 100</div><div class="line">Gen          1  Best =          36  11010101101010101111111110010111101101111011110111</div><div class="line">Gen          2  Best =          37  10111111001010101111111110010111101101111011110111</div><div class="line">Gen          3  Best =          37  10111111001010101111111110010111101101111011110111</div><div class="line">...</div><div class="line">Gen         24  Best =          49  11111111111111111111101111111111111111111111111111</div><div class="line">Gen         25  Best =          49  11111111111111111111101111111111111111111111111111</div><div class="line">Gen         26  Best =          50  11111111111111111111111111111111111111111111111111</div><div class="line">[2017-06-27 10:40:43.015243] FitnessTerminationHook: Reached fitness value = 50 == 50. Terminating...</div><div class="line">[2017-06-27 10:40:43.015302] Evolution stopped at generation 26, evaluation 2700</div><div class="line">[2017-06-27 10:40:43.015356] Time Report: [S] 0.819835 [M] 0.538455 [E] 1.19001 [F] 0.0369009 [Total] 2.66796 ms</div></div><!-- fragment --><h2><a class="anchor" id="tut1-explain"></a>
Code Explaination</h2>
<p>First of all, you need to include the library header file in order to use any class out of it. <div class="fragment"><div class="line"><span class="preprocessor">#include &lt;openea/EA.h&gt;</span></div></div><!-- fragment --></p>
<p>For convinience purpose, it is good to declare using the namespace <a class="el" href="namespaceea.html">ea</a> and <a class="el" href="namespacestd.html">std</a>. <div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceea.html">ea</a>;</div><div class="line"><span class="keyword">using namespace </span>std;</div></div><!-- fragment --></p>
<p>To make our parameters more descriptive, we should define them as macro definitions. <div class="fragment"><div class="line"><span class="preprocessor">#define GENOME_LENGTH               50</span></div><div class="line"><span class="preprocessor">#define OFFSPRING_RATIO             1</span></div><div class="line"><span class="preprocessor">#define INDIVIDUAL_MUTATION_RATE    0.1</span></div><div class="line"><span class="preprocessor">#define POP_SIZE                    100</span></div></div><!-- fragment --></p>
<p>Now we come to the main program. <div class="fragment"><div class="line"><span class="keywordtype">int</span> main() {</div></div><!-- fragment --></p>
<p>First you need to create a <a class="el" href="classea_1_1_strategy.html" title="The interface for execution order (algorithm). ">Strategy</a> object. The <a class="el" href="classea_1_1_strategy.html" title="The interface for execution order (algorithm). ">Strategy</a> interface represents an evolutionary algorithm. It contains all the operators and configurations. You can think a <a class="el" href="classea_1_1_strategy.html" title="The interface for execution order (algorithm). ">Strategy</a> object is a representation of our algorithm description above. Different kinds of algorithms require different <a class="el" href="classea_1_1_strategy.html" title="The interface for execution order (algorithm). ">Strategy</a>. In this example, we use the simplest implementation of <a class="el" href="classea_1_1_strategy.html" title="The interface for execution order (algorithm). ">Strategy</a> which is <a class="el" href="classea_1_1_evolution_strategy.html" title="A trivial implementation of Evolution Strategy. ">EvolutionStrategy</a>. You create an <a class="el" href="classea_1_1_evolution_strategy.html" title="A trivial implementation of Evolution Strategy. ">EvolutionStrategy</a> object by calling its constructor with the population size using <a class="elRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/memory/shared_ptr/make_shared.html">std::make_shared()</a>. A <a class="el" href="classea_1_1_strategy.html" title="The interface for execution order (algorithm). ">Strategy</a> must be always created in the form of smart pointer. If you don't know what a smart pointer is, just copy the code for now. If you don't know what to pass into the constructor, check the API documentation of <a class="el" href="classea_1_1_evolution_strategy.html" title="A trivial implementation of Evolution Strategy. ">EvolutionStrategy</a>.</p>
<p><div class="fragment"><div class="line">    <span class="keyword">auto</span> strategy = make_shared&lt;EvolutionStrategy&gt;(POP_SIZE);</div></div><!-- fragment --></p>
<p>A <a class="el" href="classea_1_1_strategy.html" title="The interface for execution order (algorithm). ">Strategy</a> is just a frame of execution, it needs real operators in order to work. For <a class="el" href="classea_1_1_evolution_strategy.html" title="A trivial implementation of Evolution Strategy. ">EvolutionStrategy</a>, you need to add an <a class="el" href="classea_1_1_initializer.html" title="The interface for initialization method. ">Initializer</a>, <a class="el" href="classea_1_1_evaluator.html" title="The interface for evaluation method. ">Evaluator</a>, <a class="el" href="classea_1_1_selector.html" title="The interface for selection operator. ">Selector</a> and at least a <a class="el" href="classea_1_1_recombinator.html" title="The interface for recombination operator. ">Recombinator</a> and <a class="el" href="classea_1_1_mutator.html" title="The interface for mutation operator. ">Mutator</a>. You can add the operators in any order, it doesn't matter for operators with different categories. I prefer to add the initialization method first.</p>
<p>The initialization method is represented in the library as an <a class="el" href="classea_1_1_initializer.html" title="The interface for initialization method. ">Initializer</a>. The <a class="el" href="classea_1_1_initializer.html" title="The interface for initialization method. ">Initializer</a> will also determine which representation will be used in the algorithm. We will use the representation <a class="el" href="namespaceea.html#a10b491454f255d68422ce8d6d18b4d5a">BoolArrayGenome</a> (a bit string) with random initialization method, therefore we will add a <a class="el" href="namespaceea.html#a377468eec6ac0d62b5b199ec0add3bfb">BoolRandomArrayInitializer</a> to the <a class="el" href="classea_1_1_population.html" title="The class containing all the data of the evolution process. ">Population</a>. If you wonder how can you know which operator is available in the library, check the page <a class="el" href="operators.html">Built-in Classes</a>.</p>
<p><div class="fragment"><div class="line">    strategy-&gt;initializer.Create&lt;<a class="code" href="namespaceea.html#a377468eec6ac0d62b5b199ec0add3bfb">BoolRandomArrayInitializer</a>&gt;(GENOME_LENGTH);</div></div><!-- fragment --></p>
<p>In the line above, <code>strategy-&gt;initializer</code> is an <a class="el" href="classea_1_1_operator.html" title="Operator wrapper to use as a placeholder in Strategy definition. ">Operator</a> wrapper, and the function <a class="el" href="classea_1_1_operator.html#aa1f3d89415aca11fc51b0545ea4e3b63" title="Create and set the underlying operator by calling its constructor with given arguments. ">Operator::Create&lt;O&gt;()</a> will create an instance of class <code>O</code> and the arguments gave to the function will be forwarded to the constructor of type <code>O</code>. So the operator that we've just created is the same to the one when we call the constructor: </p><div class="fragment"><div class="line"><a class="code" href="namespaceea.html#a377468eec6ac0d62b5b199ec0add3bfb">BoolRandomArrayInitializer</a>(GENOME_LENGTH)</div></div><!-- fragment --><p> The newly created object will be added to the corresponding operator category (<a class="el" href="classea_1_1_evolution_strategy.html#a49c35edbb790b244fed897a70342e3ec">EvolutionStrategy::initializer</a> in this case).</p>
<p>Using such syntax, we can add our mutation operator to the <a class="el" href="classea_1_1_evolution_strategy.html" title="A trivial implementation of Evolution Strategy. ">EvolutionStrategy</a>. The interface for mutation is <a class="el" href="classea_1_1_mutator.html" title="The interface for mutation operator. ">Mutator</a> and the class we'll use is FlipBitMutation.</p>
<p><div class="fragment"><div class="line">    strategy-&gt;mutators.CreateBase&lt;<a class="code" href="namespaceea.html#a065bdb73fa6926259b9d2a3433ea2a61">FlipBitMutation</a>&gt;(1.0 / GENOME_LENGTH)-&gt;Rate(INDIVIDUAL_MUTATION_RATE);</div></div><!-- fragment --></p>
<p>Notice, in this time, we used <a class="el" href="classea_1_1_operator.html#abe2000ed5413e44fec1c8dc52cbc8e5d" title="Create an object of class O and feed it in the contructor of class T. ">Operator::CreateBase&lt;O&gt;()</a> instead of <a class="el" href="classea_1_1_operator.html#aa1f3d89415aca11fc51b0545ea4e3b63" title="Create and set the underlying operator by calling its constructor with given arguments. ">Operator::Create&lt;O&gt;()</a>. The difference between the two functions is <a class="el" href="classea_1_1_operator.html#aa1f3d89415aca11fc51b0545ea4e3b63" title="Create and set the underlying operator by calling its constructor with given arguments. ">Operator::Create&lt;O&gt;()</a> creates and returns an object of type <code>O</code> and <a class="el" href="classea_1_1_operator.html#abe2000ed5413e44fec1c8dc52cbc8e5d" title="Create an object of class O and feed it in the contructor of class T. ">Operator::CreateBase&lt;O&gt;()</a> still creates an object of class <code>O</code> but then use it to creates and returns another object of the wrapped <a class="el" href="classea_1_1_operator.html" title="Operator wrapper to use as a placeholder in Strategy definition. ">Operator</a> type. The wrapped type in this case is <a class="el" href="classea_1_1_meta_mutator.html" title="Wrapper of Mutator and its corresponding mutation rate. ">MetaMutator</a> (you can check by seeing <a class="el" href="classea_1_1_evolution_strategy.html#ac756d5d979ea74bbbf96e53ace9f2caf">EvolutionStrategy::mutators</a> type), which wraps a <a class="el" href="classea_1_1_mutator.html" title="The interface for mutation operator. ">Mutator</a> (mutation operator) with a mutation rate. Therefore you can set the rate by using the cascading function <a class="el" href="classea_1_1_meta_mutator.html#a1e25b06aab791b3df09ef9694cfd89de" title="Alias of SetRate(). ">MetaMutator::Rate()</a>. If this is too complicate for you, just use it for now.</p>
<p>Now we will add our recombination operator (<a class="el" href="classea_1_1_recombinator.html" title="The interface for recombination operator. ">Recombinator</a> interface, I guess now you can figure out the naming convention). We will add the <a class="el" href="namespaceea.html#a234746e841e0418eda3dc897df9ccb7c">BoolOnePointCrossover</a> with <a class="el" href="classea_1_1_uniform_selection.html" title="Implementation of Uniform selection operator. ">UniformSelection</a> as the parent selection method by using the similar syntax:</p>
<p><div class="fragment"><div class="line">    strategy-&gt;recombinators.CreateBase&lt;<a class="code" href="namespaceea.html#a234746e841e0418eda3dc897df9ccb7c">BoolOnePointCrossover</a>&gt;()-&gt;Parent&lt;UniformSelection&gt;()-&gt;Ratio(OFFSPRING_RATIO);</div></div><!-- fragment --></p>
<p>Again, we used the function <a class="el" href="classea_1_1_operator.html#abe2000ed5413e44fec1c8dc52cbc8e5d" title="Create an object of class O and feed it in the contructor of class T. ">Operator::CreateBase&lt;O&gt;()</a> because we don't want to get the <a class="el" href="namespaceea.html#a234746e841e0418eda3dc897df9ccb7c">BoolOnePointCrossover</a> object, but the wrapped <a class="el" href="classea_1_1_operator.html" title="Operator wrapper to use as a placeholder in Strategy definition. ">Operator</a> type which is <a class="el" href="classea_1_1_meta_recombinator.html" title="Wrapper of Recombinator with its corresponding parent Selector and offspring ratio. ">MetaRecombinator</a>, so we can use cascading functions such as <a class="el" href="classea_1_1_meta_recombinator.html#a15430a1d0a80e776edb66100321d0cd5" title="Create a Selector of type S with given arguments and and set it as the parent selection method...">MetaRecombinator::Parent()</a> for parent selection method and <a class="el" href="classea_1_1_meta_recombinator.html#a92065d83ed03a9cbaa825b6d6832f1f3" title="Alias of SetRatio(). ">MetaRecombinator::Ratio()</a> for offspring ratio. In a nutshell, only use <a class="el" href="classea_1_1_operator.html#abe2000ed5413e44fec1c8dc52cbc8e5d" title="Create an object of class O and feed it in the contructor of class T. ">Operator::CreateBase&lt;O&gt;()</a> if you need to use cascading functions.</p>
<p>The syntax of adding the survival selection method (<a class="el" href="classea_1_1_selector.html" title="The interface for selection operator. ">Selector</a> interface, the same interface with <a class="el" href="classea_1_1_uniform_selection.html" title="Implementation of Uniform selection operator. ">UniformSelection</a> above) looks normal again:</p>
<p><div class="fragment"><div class="line">    strategy-&gt;survivalSelector.Create&lt;GreedySelection&gt;();</div></div><!-- fragment --></p>
<p>Finally, we will create our evaluation function next. This is the hardest part, because now you need to write for yourself some line of codes. The interface for it in the library is <a class="el" href="classea_1_1_evaluator.html" title="The interface for evaluation method. ">Evaluator</a>. Because the evaluation method is problem-dependent, the library can't provide you any built-in class for the <a class="el" href="classea_1_1_evaluator.html" title="The interface for evaluation method. ">Evaluator</a>. But it provides you instead a way to define an <a class="el" href="classea_1_1_evaluator.html" title="The interface for evaluation method. ">Evaluator</a> in-place which is called <a class="el" href="classea_1_1_typed_functional_evaluator.html" title="A TypedScalarEvaluator which accepts an std::function as the evaluation function. ...">TypedFunctionalEvaluator</a>. Basically, what you need is a <a class="elRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a> which accepts an object with the type of the representation (<a class="el" href="namespaceea.html#a10b491454f255d68422ce8d6d18b4d5a">BoolArrayGenome</a> in this case) and produces a fitness value of type double. You can make this <a class="elRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a> by simply creating a lambda function in C++:</p>
<p><div class="fragment"><div class="line">    strategy-&gt;evaluator.Create&lt;TypedFunctionalEvaluator&lt;BoolArrayGenome&gt;&gt;( [] (<span class="keyword">const</span> <a class="code" href="namespaceea.html#a4f7f71b4c4c608cb4e0fc207a60a23d3">BoolArrayGenomePtr</a>&amp; genome) {</div><div class="line">        vector&lt;bool&gt;&amp; genes = genome-&gt;GetGenes();</div><div class="line">        <span class="keywordflow">return</span> (<span class="keywordtype">double</span>)<a class="codeRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/algorithm/count.html">std::count</a>(genes.begin(), genes.end(), <span class="keyword">true</span>);</div><div class="line">    });</div></div><!-- fragment --></p>
<p>If you wonder what is <a class="el" href="namespaceea.html#a4f7f71b4c4c608cb4e0fc207a60a23d3">BoolArrayGenomePtr</a>, it is the typedef name for <a class="elRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/memory/shared_ptr.html">std::shared_ptr&lt;BoolArrayGenome&gt;</a>. Every class in the library also comes with an alias name for the smart pointer type by adding the suffix <code>-Ptr</code> to the class name. If you don't know what a smart pointer is, just use it as a normal pointer but don't delete it. It will automatically be deleted just like the garbage collection feature in Java and C#.</p>
<p>Before starting the evolution process, you need to specify the output mechanism and also the termination condition. The library classifies all other features which don't affect to the evolution process into <a class="el" href="classea_1_1_hook.html" title="The interface for custom code execution. ">Hook</a> category. A <a class="el" href="classea_1_1_hook.html" title="The interface for custom code execution. ">Hook</a> is a segment of custom code which will be run each generation. In this tutorial, we will use the <a class="el" href="classea_1_1_standard_output_hook.html" title="A Hook which prints out best organism every generation. ">StandardOutputHook</a> to print out the best individual of each generation and the <a class="el" href="classea_1_1_fitness_termination_hook.html" title="A Hook which will terminate the Population based on a fitness condition. ">FitnessTerminationHook</a> as the termination condition.</p>
<p><div class="fragment"><div class="line">    strategy-&gt;hooks.Create&lt;StandardOutputHook&gt;();</div><div class="line">    strategy-&gt;hooks.Create&lt;FitnessTerminationHook&gt;(<a class="code" href="classea_1_1_fitness_termination_hook.html#ae7ed3ee53a3f0a38f9741b4d0857859aaabc9e3441dc6ae6da9c1c3019d292048">FitnessTerminationHook::EQUAL_TO</a>, GENOME_LENGTH, <span class="keyword">false</span>);</div></div><!-- fragment --></p>
<p>You can check the API description to know which arguments that a type needs for its constructor. For example, for the <a class="el" href="classea_1_1_fitness_termination_hook.html" title="A Hook which will terminate the Population based on a fitness condition. ">FitnessTerminationHook</a>, you can look at here <a class="el" href="classea_1_1_fitness_termination_hook.html#ad266b90738672462bbd7c36ba5cb3230" title="Create a FitnessTerminationHook with the given condition and target fitness. ">FitnessTerminationHook::FitnessTerminationHook()</a>.</p>
<p>The last thing that you need to do is calling <a class="el" href="classea_1_1_strategy.html#a79aeeb32f547061867ca6ee90a1f560b" title="Use this Strategy to evolve the given Population. ">Strategy::Evolve()</a> and enjoy the result.</p>
<p><div class="fragment"><div class="line">    <a class="code" href="namespaceea.html#af551c7bd55451130c5d94f3371c263b1">SessionPtr</a> session = strategy-&gt;Evolve();</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --></p>
<h1><a class="anchor" id="tut1-conclusion"></a>
Conclusion</h1>
<p>This tutorial has shown you how to write a simple program using EA library to solve the One-Max problem. We knew how to translate a simple algorithm description into a real implementation by following these steps:</p>
<ul>
<li>Create a <a class="el" href="classea_1_1_evolution_strategy.html" title="A trivial implementation of Evolution Strategy. ">EvolutionStrategy</a> and specify the population size.</li>
<li>Add operators into the newly created <a class="el" href="classea_1_1_population.html" title="The class containing all the data of the evolution process. ">Population</a> object:<ul>
<li>Initialization: <a class="el" href="classea_1_1_evolution_strategy.html#a49c35edbb790b244fed897a70342e3ec">EvolutionStrategy::initializer</a></li>
<li>Mutation: <a class="el" href="classea_1_1_evolution_strategy.html#ac756d5d979ea74bbbf96e53ace9f2caf">EvolutionStrategy::mutators</a></li>
<li>Recombination: <a class="el" href="classea_1_1_evolution_strategy.html#a48c808fc7b26bc67dcd2cd8069dd04e3">EvolutionStrategy::recombinators</a></li>
<li>Survival selection: <a class="el" href="classea_1_1_evolution_strategy.html#a87af8a69fbaf134462a2711f54dd1e19">EvolutionStrategy::survivalSelector</a></li>
<li>Evaluation function: <a class="el" href="classea_1_1_evolution_strategy.html#a69dd9d35a1690222ac12eb59086e5b06">EvolutionStrategy::evaluator</a></li>
<li>Termination condition and Output: <a class="el" href="classea_1_1_strategy.html#af3899de3880a6a4f9628f1cbdfded451">EvolutionStrategy::hooks</a></li>
</ul>
</li>
<li>Call <a class="el" href="classea_1_1_strategy.html#a79aeeb32f547061867ca6ee90a1f560b" title="Use this Strategy to evolve the given Population. ">EvolutionStrategy::Evolve()</a> to start the evolution process.</li>
</ul>
<p>In the next tutorial, you will know how to solve the One-Max problem again by using the CLI toolset:</p>
<p><a class="el" href="tut2.html">Solve the One-Max problem using the CLI</a></p>
<h2><a class="anchor" id="tut1-note"></a>
Note</h2>
<p>No matter which order you add the operators into the <a class="el" href="classea_1_1_evolution_strategy.html" title="A trivial implementation of Evolution Strategy. ">EvolutionStrategy</a>, the execution of operators in still the same. You can customize it by using other <a class="el" href="classea_1_1_strategy.html" title="The interface for execution order (algorithm). ">Strategy</a>, but for this simple problem, just use the simplest one. The detailed execution loop is:</p><ul>
<li>Spawning (Recombination)</li>
<li>Mutation</li>
<li>Evaluation</li>
<li>Filtering (Survival selection)</li>
<li>Hook execution</li>
</ul>
<p>You cannot have multiple <a class="el" href="classea_1_1_initializer.html" title="The interface for initialization method. ">Initializer</a>, survival <a class="el" href="classea_1_1_selector.html" title="The interface for selection operator. ">Selector</a>, or <a class="el" href="classea_1_1_evaluator.html" title="The interface for evaluation method. ">Evaluator</a> in the same <a class="el" href="classea_1_1_evolution_strategy.html" title="A trivial implementation of Evolution Strategy. ">EvolutionStrategy</a>. If you create another one, the old one will be discarded.</p>
<p>However, you can have multiple <a class="el" href="classea_1_1_mutator.html" title="The interface for mutation operator. ">Mutator</a>, <a class="el" href="classea_1_1_recombinator.html" title="The interface for recombination operator. ">Recombinator</a> (with its parent <a class="el" href="classea_1_1_selector.html" title="The interface for selection operator. ">Selector</a>) and <a class="el" href="classea_1_1_hook.html" title="The interface for custom code execution. ">Hook</a> in the same <a class="el" href="classea_1_1_evolution_strategy.html" title="A trivial implementation of Evolution Strategy. ">EvolutionStrategy</a>. <a class="el" href="classea_1_1_mutator.html" title="The interface for mutation operator. ">Mutator</a> and <a class="el" href="classea_1_1_hook.html" title="The interface for custom code execution. ">Hook</a> will be executed in series, one after another (now, it depends on the order that you add the operators). <a class="el" href="classea_1_1_recombinator.html" title="The interface for recombination operator. ">Recombinator</a> will spawn children in parallel. So having two <a class="el" href="classea_1_1_recombinator.html" title="The interface for recombination operator. ">Recombinator</a> whose offspring ratio is equal to 1, will spawn 200 children for a population with size of 100 (100 children from each <a class="el" href="classea_1_1_recombinator.html" title="The interface for recombination operator. ">Recombinator</a>). </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
