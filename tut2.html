<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>OpenEA: Solve the One-Max problem using the CLI</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenEA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('tut2.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Solve the One-Max problem using the CLI </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#tut2-cli">The CLI toolset</a></li>
<li class="level1"><a href="#tut2-addon">Writing an add-on</a></li>
<li class="level1"><a href="#tut2-eaml">Writing an EAML file</a></li>
<li class="level1"><a href="#tut2-run">Using the CLI toolset</a></li>
<li class="level1"><a href="#tut2-conclusion">Conclusion</a><ul><li class="level2"><a href="#tut2-note">Note</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>This page describes how to use the Command Line Interface toolset (CLI) to implement the EA for One Max problem.</p>
<dl class="section user"><dt>Tutorial level</dt><dd>Beginner</dd></dl>
<dl class="section user"><dt>Previous tutorial</dt><dd><a class="el" href="tut1.html">How to solve the One-Max problem</a></dd></dl>
<dl class="section user"><dt>Next tutorial</dt><dd><a class="el" href="tut3.html">Control the algorithm via CLI options</a></dd></dl>
<h1><a class="anchor" id="tut2-cli"></a>
The CLI toolset</h1>
<p>The library comes with a Command-Line Interface toolset called EA-CLI. The toolset allows users to modify the algorithm without re-compiling, enable fast prototyping and tuning. This also make the library accessible to people who don't know C++. The toolset is available by using the command <code><b>"openea"</b></code>, which should be available if you install the library using <code><b>apt-get install libopenea-cli</b></code> or using the script <code><b>install.sh</b></code> on git repository.</p>
<dl class="section note"><dt>Note</dt><dd><code><b>"openea"</b></code> is the common entry point for also numerous utilities of the library. For example, you could use <code><b>"openea doc"</b></code> to open this HTML documentation in your default browser (only available for those who install from git repository).</dd></dl>
<p>Here, I describe briefy what you will need to do in order to use the CLI toolset.</p><ol type="1">
<li>First, you need to write a stand-alone <a class="el" href="classea_1_1_evaluator.html" title="The interface for evaluation method. ">Evaluator</a> as an add-on class.</li>
<li>Then, instead of writing a program, you will write an EAML configuration file for the CLI toolset.</li>
<li>Finally, you will run your algorithm by feeding the EAML file to the CLI toolset.</li>
</ol>
<h1><a class="anchor" id="tut2-addon"></a>
Writing an add-on</h1>
<p>An add-on is just a custom class users want to add to the system. It won't come with the library, but it will be available when you use the CLI. Writing an add-on class is just like writing a normal class, but you need to save it in a specific folder and add some "meta-data" to the class (using macros). The folder that you need to save your source code (the <b>add-on folder</b>) can be queried by using the command <code><b>"openea addon pwd"</b></code>. Also, an add-on class must have a header file (.h), you cannot write it entirely in a source file (.cpp) (but it is OK if you want to put everything in the header file by using a ton of inline functions).</p>
<dl class="section note"><dt>Note</dt><dd>The command <code><b>"openea addon ..."</b></code> will execute the <code><b>"..."</b></code> part in the add-on folder. For example, you can use <code><b>"openea addon nano foo.txt"</b></code> to edit a file <code>foo.txt</code> in the add-on folder.</dd></dl>
<p>In this tutorial, we must write for ourselves an <a class="el" href="classea_1_1_evaluator.html" title="The interface for evaluation method. ">Evaluator</a> in order to use the CLI (because it is problem-dependent). We will call our class <code>OneMaxEvaluator</code>, and create two files <code>OneMaxEvaluator.cpp</code> and <code>OneMaxEvaluator.h</code> in the add-on folder. You can use the command <code><b>"openea addon nano ..."</b></code> to edit a file directly in the add-on folder or use <code><b>"openea addon pwd"</b></code> to get the folder location and create the files by yourself. Where you save them in the add-on folder isn't matter, you can save them in any sub-folder or sub-sub-folder of the add-on folder.</p>
<p>Here is the content of the <code>OneMaxEvaluator.h</code> file:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;openea/EA.h&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceea.html">ea</a> {</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">namespace </span>addon {</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">class </span>OneMaxEvaluator: <span class="keyword">public</span> TypedScalarEvaluator&lt;BoolArrayGenome&gt; {</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <a class="code" href="_constructible_8h.html#a69c6338b567c9b319dae8f5fdf94acb9">EA_TYPEINFO_DEFAULT</a>(OneMaxEvaluator)</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;protected:</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    virtual <span class="keywordtype">double</span> DoScalarEvaluate(const <a class="code" href="namespaceea.html#a4f7f71b4c4c608cb4e0fc207a60a23d3">BoolArrayGenomePtr</a>&amp; pGenome) override;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;};</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<a class="code" href="_plugin_8h.html#a1d7d54d1612a8053e6f3e23c0b9ffc53">REGISTER_ADDON</a>(OneMaxEvaluator)</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;}</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;}</div><div class="ttc" id="_plugin_8h_html_a1d7d54d1612a8053e6f3e23c0b9ffc53"><div class="ttname"><a href="_plugin_8h.html#a1d7d54d1612a8053e6f3e23c0b9ffc53">REGISTER_ADDON</a></div><div class="ttdeci">#define REGISTER_ADDON(CLASS)</div><div class="ttdef"><b>Definition:</b> <a href="_plugin_8h_source.html#l00027">Plugin.h:27</a></div></div>
<div class="ttc" id="_constructible_8h_html_a69c6338b567c9b319dae8f5fdf94acb9"><div class="ttname"><a href="_constructible_8h.html#a69c6338b567c9b319dae8f5fdf94acb9">EA_TYPEINFO_DEFAULT</a></div><div class="ttdeci">#define EA_TYPEINFO_DEFAULT(CLASS)</div><div class="ttdef"><b>Definition:</b> <a href="_constructible_8h_source.html#l00052">Constructible.h:52</a></div></div>
<div class="ttc" id="namespaceea_html"><div class="ttname"><a href="namespaceea.html">ea</a></div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00025">Common.h:25</a></div></div>
<div class="ttc" id="namespaceea_html_a4f7f71b4c4c608cb4e0fc207a60a23d3"><div class="ttname"><a href="namespaceea.html#a4f7f71b4c4c608cb4e0fc207a60a23d3">ea::BoolArrayGenomePtr</a></div><div class="ttdeci">ea::Ptr&lt; BoolArrayGenome &gt; BoolArrayGenomePtr</div><div class="ttdef"><b>Definition:</b> <a href="_type_2_array_8h_source.html#l00017">Array.h:17</a></div></div>
</div><!-- fragment --><p>And the <code>OneMaxEvaluator.cpp</code> file:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;OneMaxEvaluator.h&quot;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceea.html">ea</a>;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">using namespace </span>std;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keywordtype">double</span> ea::addon::OneMaxEvaluator::DoScalarEvaluate(<span class="keyword">const</span> <a class="codeRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/memory/shared_ptr.html">BoolArrayGenomePtr</a>&amp; pGenome) {</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    <a class="codeRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/container/vector.html">vector&lt;bool&gt;</a>&amp; genes = pGenome-&gt;GetGenes();</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">double</span>)<a class="codeRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/algorithm/count.html">std::count</a>(genes.<a class="codeRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), genes.<a class="codeRef" doxygen="/home/minh/repo/vgu_interns/EA/doc/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/container/vector/end.html">end</a>(), <span class="keyword">true</span>);</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;}</div><div class="ttc" id="shared_ptr_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/memory/shared_ptr.html">std::shared_ptr</a></div></div>
<div class="ttc" id="end_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/end.html">std::vector::end</a></div><div class="ttdeci">T end(T...args)</div></div>
<div class="ttc" id="namespaceea_html"><div class="ttname"><a href="namespaceea.html">ea</a></div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00025">Common.h:25</a></div></div>
<div class="ttc" id="count_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/count.html">std::count</a></div><div class="ttdeci">T count(T...args)</div></div>
<div class="ttc" id="vector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a></div></div>
<div class="ttc" id="begin_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/begin.html">std::vector::begin</a></div><div class="ttdeci">T begin(T...args)</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The namespace of the add-on class isn't matter, you can put it in whichever namespace that you want.</dd></dl>
<p>The main task is to override the <a class="el" href="classea_1_1_typed_scalar_evaluator.html#a7dd9dd562becf78d6013f88cad3fa89c" title="Implementation of the evaluation method with input of type T. ">TypedScalarEvaluator::DoScalarEvaluate()</a> function with the content from the previous tutorial. The type TypedScalarEvaluator&lt;G&gt; is a specialization of <a class="el" href="classea_1_1_evaluator.html" title="The interface for evaluation method. ">Evaluator</a>, which will handle the underlying casting part for you. The only thing you need to do is transforming the given genome type of type G (BoolArrayGenome in the case) to a fitness value of type double.</p>
<p>There are also two macros related to defining the meta-data. These macros <b>must</b> be defined in the header file. The first macro is defined at the <b>public</b> level of your class:</p>
 <div class="fragment"><div class="line">    <a class="code" href="_constructible_8h.html#a69c6338b567c9b319dae8f5fdf94acb9">EA_TYPEINFO_DEFAULT</a>(OneMaxEvaluator)</div></div><!-- fragment --></p>
<p>will define the type information (<a class="el" href="classea_1_1_type_info.html" title="Data structure containing class information. ">TypeInfo</a>) of your custom type. Basically, CLI uses an EAML configuration file to build your algorithm, so every class should have a name called the <b>EAML Name</b>. This macro defines the EAML name of your custom class the same with the real class name defined in your code. Note that you <b>cannot</b> define a different EAML name if you use the macro <a class="el" href="_constructible_8h.html#a69c6338b567c9b319dae8f5fdf94acb9">EA_TYPEINFO_DEFAULT</a>, therefore, <code>EA_TYPEINFO_DEFAULT(AnotherClassName)</code> would be invalid. (with other macros, you can, but we will mention them in another tutorial).</p>
<p>The second macro is defined <b>right after</b> the definition of your class and must be in a header file:</p>
<p><div class="fragment"><div class="line"><a class="code" href="_plugin_8h.html#a1d7d54d1612a8053e6f3e23c0b9ffc53">REGISTER_ADDON</a>(OneMaxEvaluator)</div></div><!-- fragment --></p>
<p>This macro will add the defined-above type information to the <a class="el" href="classea_1_1_name_service.html" title="Static class which provides a service to translate class name into TypeInfo. ">NameService</a>. The <a class="el" href="classea_1_1_name_service.html" title="Static class which provides a service to translate class name into TypeInfo. ">NameService</a> is a translation table between the EAML name and the class' <a class="el" href="classea_1_1_type_info.html" title="Data structure containing class information. ">TypeInfo</a>. If your class is not added to the <a class="el" href="classea_1_1_name_service.html" title="Static class which provides a service to translate class name into TypeInfo. ">NameService</a> by using this macro, the CLI has no way to know what is the EAML name of your custom class.</p>
<p>You should not compile it normally, the library provides you a proper and convenient way to do that. Simply use the command:</p>
<div class="fragment"><div class="line">openea update</div></div><!-- fragment --><p>Now you are ready to use your add-on class in the CLI toolset.</p>
<dl class="section note"><dt>Note</dt><dd>The limitation of writing add-on classes is you cannot add any other external library dependency to your code. To write custom classes which also link to external libraries, you need to write a <b>plugin</b> instead of add-on classes. We will learn how to write a plugin in future tutorial.</dd></dl>
<h1><a class="anchor" id="tut2-eaml"></a>
Writing an EAML file</h1>
<p>After adding your add-on class to the system, the remaining tasks are easy. Now you don't need to write any C++ line of code anymore, you only need to translate your algorithm description to an EAML configuration file. If you don't remember the description, check the previous tutorial <a class="el" href="tut1.html">How to solve the One-Max problem</a>. Here is the EAML file for the One-Max problem.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;?xml version=&quot;1.0&quot;?&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;&lt;EvolutionStrategy size=&quot;100&quot;&gt;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;   </div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;   &lt;initializer&gt;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;       &lt;BoolRandomArrayInitializer length=&quot;50&quot;/&gt;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;   &lt;/initializer&gt;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;   </div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;   &lt;recombinators&gt;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;       &lt;MetaRecombinator ratio=&quot;1&quot;&gt;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;           &lt;recombinator&gt;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;               &lt;BoolOnePointCrossover/&gt;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;           &lt;/recombinator&gt;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;           &lt;selector&gt;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;               &lt;UniformSelection/&gt;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;           &lt;/selector&gt;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;       &lt;/MetaRecombinator&gt;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;   &lt;/recombinators&gt;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;   </div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;   &lt;mutators&gt;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;       &lt;MetaMutator rate=&quot;0.1&quot;&gt;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;           &lt;mutator&gt;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;               &lt;FlipBitMutation rate=&quot;0.02&quot;/&gt;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;           &lt;/mutator&gt;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;       &lt;/MetaMutator&gt;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   &lt;/mutators&gt;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   </div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   &lt;survival-selector&gt;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;       &lt;GreedySelection/&gt;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   &lt;/survival-selector&gt;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   </div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   &lt;evaluator&gt;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;       &lt;OneMaxEvaluator/&gt;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   &lt;/evaluator&gt;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   </div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   &lt;hooks&gt;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;       &lt;StandardOutputHook/&gt;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;       &lt;FitnessTerminationHook condition=&quot;==&quot; threshold=&quot;50&quot;/&gt;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   &lt;/hooks&gt;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   </div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;&lt;/EvolutionStrategy&gt;</div></div><!-- fragment --><p>The file should explain itself. You can notice that EAML syntax is the same with XML syntax. But there are some additional requirements. First, the root element must be a <a class="el" href="classea_1_1_strategy.html" title="The interface for execution order (algorithm). ">Strategy</a> name such as <b><code>&lt;EvolutionStrategy&gt;</code></b> with an attribute <code><b>"size"</b></code> set to the population size. Inside the root element, operator groups are added. Notice that the name of operator group tags are in lower case (<code>&lt;initializer&gt;</code>, <code>&lt;mutators&gt;</code>, etc.). Also notice that the tags <code>&lt;mutators&gt;</code>, <code>&lt;recombinators&gt;</code>, <code>&lt;hooks&gt;</code> have the suffix "-s", that means multiple operators of those groups can be added (e.g. <code>&lt;hooks&gt;</code> has two children). How can I know which fields need to be filled? Just see the API documentation of <a class="el" href="classea_1_1_evolution_strategy.html" title="A trivial implementation of Evolution Strategy. ">EvolutionStrategy</a>.</p>
<p>In the EAML file, you must use EAML names. You can find the name from the API document of each class or just simply access this page: <a class="el" href="operators.html">Built-in Classes</a>. The names of arguments of an operator are also described in the API document. For example, from this page: <a class="el" href="classea_1_1_random_array_initializer.html" title="A random Initializer for ArrayGenome. ">RandomArrayInitializer</a>, you can find out the EAML name and the EAML attribute names of <code><b> BoolRandomArrayInitializer</b></code>, which requires an attribute <code><b>"length"</b></code> for the length of the bit string.</p>
<p><a class="el" href="classea_1_1_mutator.html" title="The interface for mutation operator. ">Mutator</a> and <a class="el" href="classea_1_1_recombinator.html" title="The interface for recombination operator. ">Recombinator</a> must be added in a special way. We already knew in the previous tutorial that those operators must be used with <a class="el" href="classea_1_1_operator.html#abe2000ed5413e44fec1c8dc52cbc8e5d" title="Create an object of class O and feed it in the contructor of class T. ">Operator::CreateBase()</a>. <a class="el" href="classea_1_1_mutator.html" title="The interface for mutation operator. ">Mutator</a> must be included with a mutation rate wrapped in a <a class="el" href="classea_1_1_meta_mutator.html" title="Wrapper of Mutator and its corresponding mutation rate. ">MetaMutator</a> and <a class="el" href="classea_1_1_recombinator.html" title="The interface for recombination operator. ">Recombinator</a> must come with a parent <a class="el" href="classea_1_1_selector.html" title="The interface for selection operator. ">Selector</a> and an offspring ratio wrapped in a <a class="el" href="classea_1_1_meta_recombinator.html" title="Wrapper of Recombinator with its corresponding parent Selector and offspring ratio. ">MetaRecombinator</a>. In the EAML file, they must follow in this template (which you can check in the API documentation of <a class="el" href="classea_1_1_meta_mutator.html" title="Wrapper of Mutator and its corresponding mutation rate. ">MetaMutator</a> and <a class="el" href="classea_1_1_meta_recombinator.html" title="Wrapper of Recombinator with its corresponding parent Selector and offspring ratio. ">MetaRecombinator</a>):</p>
<div class="fragment"><div class="line">&lt;MetaRecombinator ratio=<span class="stringliteral">&quot;...&quot;</span>&gt;</div><div class="line">    &lt;recombinator&gt;</div><div class="line">        ...</div><div class="line">    &lt;/recombinator&gt;</div><div class="line">    &lt;selector&gt;</div><div class="line">        ...</div><div class="line">    &lt;/selector&gt;</div><div class="line">&lt;/MetaRecombinator&gt;</div></div><!-- fragment --><p>for <a class="el" href="classea_1_1_recombinator.html" title="The interface for recombination operator. ">Recombinator</a>. And for <a class="el" href="classea_1_1_mutator.html" title="The interface for mutation operator. ">Mutator</a>: </p><div class="fragment"><div class="line">&lt;MetaMutator rate=<span class="stringliteral">&quot;...&quot;</span>&gt;</div><div class="line">    &lt;mutator&gt;</div><div class="line">        ...</div><div class="line">    &lt;/mutator&gt;</div><div class="line">&lt;/MetaMutator&gt;</div></div><!-- fragment --><p>Now, save the file with the extension <code>.eaml</code> (e.g. <code>OneMax.eaml</code>). Our algorithm is ready to be run.</p>
<h1><a class="anchor" id="tut2-run"></a>
Using the CLI toolset</h1>
<p>To run our EAML file, use this command (you can replace <code>OneMax.eaml</code> to your file name):</p>
<div class="fragment"><div class="line">openea run OneMax.eaml</div></div><!-- fragment --><p>Example output (some lines of the evolution process are omitted):</p>
<div class="fragment"><div class="line">[2017-06-27 11:47:50.479327] PluginLoader: Loaded 0 plugin(s).</div><div class="line">[2017-06-27 11:47:50.479457] CLI: Reading OneMax.eaml</div><div class="line">[2017-06-27 11:47:50.479791] CLI: <span class="stringliteral">&quot;EvolutionStrategy&quot;</span> reconstructed</div><div class="line">[2017-06-27 11:47:50.479837] CLI: BackupHook not found. Default one added to folder <span class="stringliteral">&quot;~/.openea/.backup&quot;</span>.</div><div class="line">[2017-06-27 11:47:50.491210] Parallel processing is enabled, number of threads = 4</div><div class="line">[2017-06-27 11:47:50.492406] <a class="code" href="classea_1_1_backup_hook.html#abb170210410b287564c5f7bc4c340bad">BackupHook::DoInitial</a>: Cleared 1 file(s) in &quot;~/.openea/.backup&quot;.</div><div class="line">[2017-06-27 11:47:50.492437] Population initialized, evaluation 100</div><div class="line">[2017-06-27 11:47:50.492459] Evolution started from generation 0, evaluation 100</div><div class="line">Gen       1 Best =         33   00010101111010101110101101101111011111001110111110</div><div class="line">Gen       2 Best =         36   11101111011010100011100111111111101111001111111100</div><div class="line">Gen       3 Best =         37   10111111010111011111000011111110111111001110111110</div><div class="line">...</div><div class="line">Gen      21 Best =         49   11111111111111111111111111111111111111111111111110</div><div class="line">Gen      22 Best =         49   11111111111111111111111111111111111111111111111110</div><div class="line">Gen      23 Best =         50   11111111111111111111111111111111111111111111111111</div><div class="line">[2017-06-27 11:47:50.514198] FitnessTerminationHook: Reached fitness value = 50 == 50. Terminating...</div><div class="line">[2017-06-27 11:47:50.514893] BackupHook: Backup saved to &quot;~/.openea/.backup/000023.eabak&quot;.</div><div class="line">[2017-06-27 11:47:50.514950] Evolution stopped at generation 23, evaluation 2400</div><div class="line">[2017-06-27 11:47:50.514988] Time Report: [S] 0.215576 [M] 0.234679 [E] 0.231562 [F] 0.0530683 [Total] 0.814752 ms</div></div><!-- fragment --><p>The output has some more messages for us, compared to the one of the previous tutorial. The most important feature is that the CLI toolset will automatically save back-up file for you when the evolution process ends. You can, of course, add a <a class="el" href="classea_1_1_backup_hook.html" title="A Hook which backs up the Population to file. ">BackupHook</a> to the previous tutorial, but for the CLI toolset, it will be automatically added.</p>
<dl class="section note"><dt>Note</dt><dd>A <a class="el" href="classea_1_1_backup_hook.html" title="A Hook which backs up the Population to file. ">BackupHook</a> is a <a class="el" href="classea_1_1_hook.html" title="The interface for custom code execution. ">Hook</a> which will save back-up file at the end of the evolution. You can also save back-up files after a few generations. Read the API documentation for more details.</dd></dl>
<p>If you saw a error message like this:</p>
<div class="fragment"><div class="line">Fatal Error: ../src/rtoc/NameService.cpp:41 : CLASS_NAME_NOT_EXIST - OneMaxEvaluator <span class="keyword">class </span>does not exist in Name service.</div></div><!-- fragment --><p>That means you didn't compile the new add-on files in the previous step. In that case, run <code><b>"openea update"</b></code> to compile the add-on, then <code><b>"openea run"</b></code> should work properly.</p>
<p>The great thing of using an interface like this CLI toolset is that you don't need to recompile anything anymore. If you want that change the population size or the genome length for example, you can simply edit the EAML file and call <code><b>"openea run"</b></code> again. <code><b>"openea update"</b></code> is not required, unless you also changed the code of your add-on class.</p>
<dl class="section note"><dt>Note</dt><dd>The CLI toolset even has a faster method to set the value of the attributes. We will look into it in the next tutorial.</dd></dl>
<h1><a class="anchor" id="tut2-conclusion"></a>
Conclusion</h1>
<p>This tutorial has shown you how to use the CLI toolset to solve the One-Max problem. The usual process to run an algorithm using the CLI is:</p>
<ul>
<li>Write an add-on class in the add-on folder.</li>
<li>Compile the add-on class using <code><b>"openea update"</b></code>.</li>
<li>Write an EAML configuration file describing the algorithm.</li>
<li>Call <code><b>"openea run file_name.eaml"</b></code> to run the the EAML file.</li>
</ul>
<p>The next tutorial will show you how to use CLI options to add more features to the algorithm:</p>
<p><a class="el" href="tut3.html">Control the algorithm via CLI options</a></p>
<h2><a class="anchor" id="tut2-note"></a>
Note</h2>
<p>Similar to the previous tutorial, the order of operator groups is not important. The execution cycle will be always the same. However, the order of <a class="el" href="classea_1_1_mutator.html" title="The interface for mutation operator. ">Mutator</a>, <a class="el" href="classea_1_1_recombinator.html" title="The interface for recombination operator. ">Recombinator</a> and <a class="el" href="classea_1_1_hook.html" title="The interface for custom code execution. ">Hook</a> in the same operator group is matter. In the above example, <a class="el" href="classea_1_1_fitness_termination_hook.html" title="A Hook which will terminate the Population based on a fitness condition. ">FitnessTerminationHook</a> will always run after <a class="el" href="classea_1_1_standard_output_hook.html" title="A Hook which prints out best organism every generation. ">StandardOutputHook</a>, because of the order of them in the EAML file.</p>
<p>If we call the root level of the EAML file level 1 (the tag <code>&lt;Population&gt;</code>), then</p>
<ul>
<li>The element names at odd levels (1, 3, 5, etc.) are always the name of classes (EAML names - e.g. <code>&lt;Population&gt;</code>, <code>&lt;MetaRecombinator&gt;</code>, <code>&lt;FlipBitMutation&gt;</code>, <code>&lt;OneMaxEvaluator&gt;</code>). Class names are always in upper camel case (<code>UpperCamelCase</code>).</li>
<li>The element names at even levels (2, 4, 6, etc.) are always the name of attributes (EAML attributes - e.g. <code>&lt;initializer&gt;</code>, <code>&lt;recombinator&gt;</code>, <code>&lt;hooks&gt;</code>). Attribute names are always in lower case connected by dashes (<code>lower-case</code>).</li>
</ul>
<p>Remember this rule might help you remembering the template of EAML format.</p>
<p><a class="el" href="classea_1_1_meta_mutator.html" title="Wrapper of Mutator and its corresponding mutation rate. ">MetaMutator</a> and <a class="el" href="classea_1_1_meta_recombinator.html" title="Wrapper of Recombinator with its corresponding parent Selector and offspring ratio. ">MetaRecombinator</a> are real class names, which store addition information of a <a class="el" href="classea_1_1_mutator.html" title="The interface for mutation operator. ">Mutator</a> and a <a class="el" href="classea_1_1_recombinator.html" title="The interface for recombination operator. ">Recombinator</a> such as rate, parent <a class="el" href="classea_1_1_selector.html" title="The interface for selection operator. ">Selector</a> and ratio. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
